---
title: JavaScript-闭包
toc: true
tags: JavaScript 基础知识 闭包
date: 2019-09-25
categories:
- [JavaScript, 基础]
---

### 闭包的作用
###### 一个函数可以访问外部函数的内部变量，构成一个闭包环境(函数嵌套  引用外部函数变量，  内部函数有一个对象，存储外部被引用的变量)
```js
闭包的生命周期：在嵌套的内部函数成为垃圾对象时
也就是不再被引用
```
### 闭包作用
```js


1. 变量维持的内存中
2. 保护内部变量，以防造成污染
   - 但是会造成内存泄露
```
### 使用场景---自定义js模块  

```js

开发中经常用到的函数，格式化时间日期的，判断是否是数字的等等，封装到一个模块里面，  
在需要使用的地方引入。不能直接访问内部的东西，但是可以通过暴露接口给外部，操作内部的数据
```
### 代码示例
```js
  <script>
     function fun(n, o) {
        console.log(o);
        return {
            fun:function(m) {
                return fun(m, n);
            }
        }
     } 
     
     //   var b = fun(0).fun(1).fun(2).fun(3);  //0 1 2    
   // m1no n 1 o 0    m 2 n 1  n 2 o 1    m 3 n 2  n 3 o 2

    //  var a = fun(0);
    //  a.fun(1);//m 1 n 0
    //  a.fun(2); // m2 n 0
    //  a.fun(3); //m 3 n 0

     var c = fun(0).fun(1); // m 1 n 0 n 1 o 0   
      c.fun(2); // m 2 n 1 n 2 o 1 
      c.fun(3); //  m 3 n 1  n 3 o 1
```
###### 闭包的缺点
```js
函数执行完后，函数内部局部变量没有释放，占用内存时间会边长容易造成内存泄露
***解决---及时释放内存
结束生命=====  f=null
```

###### 闭包的暴力理解

```js
在使用闭包时候，当函数执行完，用一个新的引入变量，去接受内部函数返回的函数对象，闭包就在函数对象里面形成了，  
作用就是 延长了外部函数变量的生命周期，以及内部函数对象的生命周期。

如果没有引入变量是不会占用内存的，产生了  又放走了。

结合截屏 看。。。对象的引用+垃圾回收机制


函数在 那个对象里面调用，this就指向那个对象。

```

### 图解
![](bibao.png)